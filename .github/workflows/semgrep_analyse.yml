name: ðŸ” Analyse SAST avec Semgrep

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  semgrep_scan:
    name: ExÃ©cuter l'analyse Semgrep
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Cloner le dÃ©pÃ´t
        uses: actions/checkout@v4

      - name: ðŸ Installer Semgrep
        run: |
          python3 -m pip install --upgrade pip
          pip install semgrep

      - name: ðŸ” ExÃ©cuter l'analyse Semgrep avec les rÃ¨gles personnalisÃ©es
        run: |
          semgrep scan --config regles_vulnerabilites.yml . > rapport_semgrep.txt || true

      - name: ðŸ•’ GÃ©nÃ©rer un nom de fichier dynamique
        id: filename
        run: echo "file_name=rapport_semgrep_$(date +'%Y%m%d_%H%M%S').txt" >> $GITHUB_ENV

      - name: ðŸ“¤ Publier le rapport Semgrep
        uses: actions/upload-artifact@v4
        with:
          name: Rapport-Semgrep
          path: rapport_semgrep.txt
